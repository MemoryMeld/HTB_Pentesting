# Host Discovery

```bash
# Send ARP requests discover IPs
netdiscover -r <Network> -i tun0
```

# Ping sweep 

```bash
# Ping Sweep
sudo nmap -n -sn 192.168.0.1/24 -oG - | awk '/Up$/{print $2}' | tee open-devices.txt
```

# Host Scanning

```bash
# SYN scan get open ports and assign to bash variable
ports=$(sudo nmap -p- 10.10.10.10 -T4 | grep ^[0-9] | cut -d '/' -f 1 | tr '\n' ',' | sed s/,$//)

# nmap default scripts and version scan 
sudo nmap -sC -sV -p$ports <IP> -oN tcp_script_scan

# nmap fast scan to check if any of the Top 1000 UDP services are running
sudo nmap -sUV --version-intensity 0 --max-retries 1 10.10.10.10 -T4 -oN udp_scan.txt

# Get udp services running, run default scripts and version scan
ports=$(cat udp_scan | sed -r 's/\s+//g' | sed -n "/udpopen/p" | grep ^[0-9] | cut -d '/' -f 1 | tr '\n' ',' | sed s/,$//)
sudo nmap -sU -sC -sV -p$ports <IP> -oN udp_script_scan

# nmap vulnerability scan
sudo nmap -sV --script vulners --script-args mincvss=7.0 -p$ports <IP>
```

# Directory fuzzing 
```bash
# wordlists 
/usr/share/seclists/Discovery/Web-Content/common.txt 
/usr/share/seclists/Discovery/Web-Content/big.txt
/usr/share/seclists/Discovery/Web-Content/raft-medium-directories.txt
/usr/share/seclists/Discovery/Web-Content/raft-large-directories.txt
/usr/share/seclists/Discovery/Web-Content/CMS/sharepoint.txt
/usr/share/seclists/Discovery/Web-Content/directory-list-2.3-small.txt 
/usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt 

# common extensions to look for
.aspx,.html,.jsp,.php,.txt,.js,.xml,.cshtml

# ffuf using recursion, -maxtime-job 60 (causes each recursive directory scan to finish after 60 seconds)
ffuf -ic -w /usr/share/seclists/Discovery/Web-Content/big.txt -e .html,.php,.txt,.js -u http://10.10.10.10:80/FUZZ -v -mc 200,301,302 -recursion -recursion-depth 2 -recursion-strategy greedy and close | tee ffuf80.txt
```
