#!/bin/bash

output=$(find / -perm /4000 -type f 2>/dev/null | xargs ls -l)
IFS=$'\n'

suid_array=($(find / -perm /4000 -type f 2>/dev/null | xargs ls -l | awk '{print $NF}'))

original_suid_array=($output)

def_list=("arping" "at" "bwrap" "chfn" "chrome-sandbox" "chsh" "dbus-daemon-launch-helper" "dmcrypt-get-device" "exim4" "fusermount" "gpasswd" "helper" "kismet_capture" "lxc-user-nic" "mount" "mount.cifs" "mount.ecryptfs_private" "mount.nfs" "newgidmap" "newgrp" "newuidmap" "ntfs-3g" "passwd" "ping" "ping6" "pkexec" "polkit-agent-helper-1" "pppd" "snap-confine" "ssh-keysign" "su" "sudo" "traceroute" "traceroute6" "traceroute6.iputils" "ubuntu-core-launcher" "umount" "VBoxHeadless" "VBoxNetAdpCtl" "VBoxNetDHCP" "VBoxNetNAT" "VBoxSDL" "VBoxVolInfo" "VirtualBoxVM" "vmware-authd" "vmware-user-suid-wrapper" "vmware-vmx" "vmware-vmx-debug" "vmware-vmx-stats" "Xorg.wrap")

gtfo_list=("ar" "aria2c" "arj" "arp" "as" "ash" "atobm" "awk" "base32" "base64" "basenc" "bash" "bridge" "busybox" "byebug" "bzip2" "capsh" "cat" "chmod" "chown" "chroot" "column" "comm" "composer" "cp" "cpio" "cpulimit" "csh" "csplit" "csvtool" "cupsfilter" "curl" "cut" "dash" "date" "dd" "dialog" "diff" "dig" "dmsetup" "docker" "dosbox" "dvips" "ed" "emacs" "env" "eqn" "expand" "expect" "file" "find" "flock" "fmt" "fold" "gawk" "gcore" "gdb" "gimp" "git" "grep" "gtester" "gzip" "hd" "head" "hexdump" "highlight" "hping3" "iconv" "iftop" "install" "ionice" "ip" "jjs" "join" "jq" "ksh" "ksshell" "latex" "ldconfig" "ld.so" "less" "logsave" "look" "lwp-download" "lua" "lualatex" "luatex" "lwp-request" "make" "mawk" "more" "msgattrib" "msgcat" "msgconv" "msgfilter" "msgmerge" "msguniq" "mv" "mysql" "nano" "nasm" "nawk" "nc" "nice" "nl" "nmap" "node" "nohup" "octave" "od" "openssl" "openvpn" "paste" "pdflatex" "pdftex" "perl" "pg" "php" "pic" "pico" "pr" "pry" "python" "rake" "readelf" "restic" "rev" "rlwrap" "rpm" "rpmquery" "rsync" "run-parts" "rview" "rvim" "scp" "sed" "setarch" "shuf" "slsh" "socat" "soelim" "sort" "sqlite3" "ss" "ssh-keygen" "ssh-keyscan" "start-stop-daemon" "stdbuf" "strace" "strings" "sysctl" "systemctl" "tac" "tail" "tar" "taskset" "tbl" "tclsh" "tee" "telnet" "tex" "tftp" "tic" "time" "timeout" "troff" "ul" "unexpand" "uniq" "unshare" "update-alternatives" "uudecode" "uuencode" "view" "vigr" "vim" "vimdiff" "vipw" "watch" "wc" "wget" "whiptail" "xargs" "xelatex" "xetex" "xmodmap" "xmore" "xxd" "xz" "zip" "zsh" "zsoelim")

suid_length=${#suid_array[@]}
def_suid_binaries=""
gtfo_suid_binaries=""
custom_suid_binaries=""

for (( i=0; i<$suid_length; i++ )); do
  binary="${suid_array[i]}"
  
  for def_binary in "${def_list[@]}"; do
    if [[ "$binary" == *"$def_binary"* ]]; then
      def_suid_binaries="$def_suid_binaries\n${original_suid_array[i]}"
      continue 2
    fi
  done
  
  for gtfo_binary in "${gtfo_list[@]}"; do
    if [[ "$binary" == *"$gtfo_binary"* ]]; then
      gtfo_suid_binaries="$gtfo_suid_binaries\n${original_suid_array[i]}"
      continue 2
    fi
  done
  
  custom_suid_binaries="$custom_suid_binaries\n${original_suid_array[i]}"
done

# Define color codes
RED="\033[00;31m"
YELLOW="\033[00;33m"
BLUE="\033[01;34m"
NC="\033[0m" # No color

echo -e "${RED}[-] Found default SUIDs:${NC}$def_suid_binaries"
echo -e "\n"
echo -e "${YELLOW}[+] Found GTFO SUIDs:${NC}$gtfo_suid_binaries"
echo -e "\n"
echo -e "${BLUE}[+] Found Custom SUIDs:${NC}$custom_suid_binaries"
echo -e "\n"
echo -e "\n"
